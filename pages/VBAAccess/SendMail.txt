document.write("\
<span class=&quot;KeyComment&quot;>'рассылка&nbspписем&nbspс&nbspпомощью&nbspобъектной&nbspмодели&nbspCDO</span><br />\
<span class=&quot;KeyWord&quot;>Function&nbsp</span>Send_Mail(<span class=&quot;KeyWord&quot;>ByVal&nbsp</span>ToAddress&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbsp<span class=&quot;KeyWord&quot;>ByVal&nbsp</span>Subject&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbsp<span class=&quot;KeyWord&quot;>Optional&nbsp</span><span class=&quot;KeyWord&quot;>ByVal&nbsp</span>Body&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String&nbsp</span>=&nbsp&quot;<default>&quot;,&nbsp<span class=&quot;KeyWord&quot;>Optional&nbsp</span><span class=&quot;KeyWord&quot;>ByVal&nbsp</span>CCAddress&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String&nbsp</span>=&nbsp&quot;&quot;,&nbsp<span class=&quot;KeyWord&quot;>Optional&nbsp</span><span class=&quot;KeyWord&quot;>ByVal&nbsp</span>BCCAddress&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String&nbsp</span>=&nbsp&quot;&quot;,&nbsp<span class=&quot;KeyWord&quot;>Optional&nbsp</span><span class=&quot;KeyWord&quot;>ByVal&nbsp</span>Attachment&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String&nbsp</span>=&nbsp&quot;&quot;,&nbsp<span class=&quot;KeyWord&quot;>Optional&nbsp</span><span class=&quot;KeyWord&quot;>ByVal&nbsp</span>IsShowMessage&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>Boolean&nbsp</span>=&nbsp<span class=&quot;KeyWord&quot;>True</span>)&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>Boolean</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>IsShowMessage&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span><span class=&quot;KeyWord&quot;>If&nbsp</span>MsgBox(&quot;Запустить?&quot;,&nbsp32&nbsp+&nbsp4&nbsp+&nbspvbDefaultButton2,&nbsp&quot;&quot;)&nbsp=&nbspvbNo&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span><span class=&quot;KeyWord&quot;>Exit&nbsp</span><span class=&quot;KeyWord&quot;>Function</span><br />\
<span class=&quot;KeyWord&quot;>Dim&nbsp</span>objAccess&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>Object</span>:&nbsp<span class=&quot;KeyWord&quot;>Set&nbsp</span>objAccess&nbsp=&nbspCreateObject(&quot;DAO.DBEngine.36&quot;)<br />\
<span class=&quot;KeyWord&quot;>Dim&nbsp</span>db&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>Object</span>:&nbsp<span class=&quot;KeyWord&quot;>Set&nbsp</span>db&nbsp=&nbspobjAccess.Workspaces(0).OpenDatabase(&quot;C:\db.accdb&quot;)<br />\
<span class=&quot;KeyWord&quot;>Dim&nbsp</span>rsEMailAccount&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>Object</span><br />\
<span class=&quot;KeyWord&quot;>Set&nbsp</span>rsEMailAccount&nbsp=&nbspdb.OpenRecordset(&quot;SELECT&nbspTOP&nbsp1&nbsp[SMTP&nbspServer],&nbspUserName,&nbspUserPassword&nbspFROM&nbspEMailAccounts&nbspWHERE&nbspНаименование&nbsp=&nbsp&quot;&nbsp+&nbspChr(34)&nbsp+&nbsp&quot;ИАО&quot;&nbsp+&nbspChr(34)&nbsp+&nbsp&quot;;&quot;)<br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>rsEMailAccount.EOF&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>MsgBox&nbsp&quot;&quot;,&nbsp16,&nbsp&quot;&quot;:&nbsp<span class=&quot;KeyWord&quot;>Exit&nbsp</span><span class=&quot;KeyWord&quot;>Function</span><br />\
rsEMailAccount.MoveFirst<br />\
<span class=&quot;KeyWord&quot;>Const&nbsp</span>CDO_Cnf&nbsp=&nbsp&quot;http://schemas.microsoft.com/cdo/configuration/&quot;<br />\
<span class=&quot;KeyWord&quot;>Dim&nbsp</span>oCDOCnf&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>Object</span>,&nbspoCDOMsg&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>Object</span><br />\
<span class=&quot;KeyWord&quot;>Dim&nbsp</span>SMTPserver&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbspsUsername&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbspsPass&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbspsMsg&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbsplMsg&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>:&nbspsMsg&nbsp=&nbsp&quot;&quot;:&nbsplMsg&nbsp=&nbsp64<br />\
<span class=&quot;KeyWord&quot;>Dim&nbsp</span>sTo&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbspsFrom&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbspsSubject&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbspsBody&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>,&nbspsAttachment&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>:&nbsp<span class=&quot;KeyWord&quot;>Dim&nbsp</span>sCC&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span>:&nbsp<span class=&quot;KeyWord&quot;>Dim&nbsp</span>sBCC&nbsp<span class=&quot;KeyWord&quot;>As&nbsp</span><span class=&quot;KeyWord&quot;>String</span><br />\
<span class=&quot;KeyComment&quot;>'sFrom&nbsp-&nbspкак&nbspправило&nbspсовпадает&nbspс&nbspsUsername</span><br />\
SMTPserver&nbsp=&nbsprsEMailAccount.Fields(&quot;SMTP&nbspServer&quot;).Value&nbsp<span class=&quot;KeyComment&quot;>'SMTPServer</span><br />\
sUsername&nbsp=&nbsprsEMailAccount.Fields(&quot;UserName&quot;).Value&nbsp<span class=&quot;KeyComment&quot;>'Учетная&nbspзапись&nbspна&nbspсервере</span><br />\
sPass&nbsp=&nbsprsEMailAccount.Fields(&quot;UserPassword&quot;).Value&nbsp<span class=&quot;KeyComment&quot;>'Пароль&nbspк&nbspпочтовому&nbspаккаунту</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>Len(SMTPserver)&nbsp=&nbsp0&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>MsgBox&nbsp&quot;Не&nbspуказан&nbspSMTP&nbspсервер&quot;,&nbspvbInformation,&nbsp&quot;&quot;:&nbsp<span class=&quot;KeyWord&quot;>Exit&nbsp</span><span class=&quot;KeyWord&quot;>Function</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>Len(sUsername)&nbsp=&nbsp0&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>MsgBox&nbsp&quot;Не&nbspуказана&nbspучетная&nbspзапись&quot;,&nbspvbInformation,&nbsp&quot;&quot;:&nbsp<span class=&quot;KeyWord&quot;>Exit&nbsp</span><span class=&quot;KeyWord&quot;>Function</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>Len(sPass)&nbsp=&nbsp0&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>MsgBox&nbsp&quot;Не&nbspуказан&nbspпароль&quot;,&nbspvbInformation,&nbsp&quot;&quot;:&nbsp<span class=&quot;KeyWord&quot;>Exit&nbsp</span><span class=&quot;KeyWord&quot;>Function</span><br />\
sTo&nbsp=&nbspToAddress&nbsp<span class=&quot;KeyComment&quot;>'Кому</span><br />\
sFrom&nbsp=&nbspsUsername&nbsp<span class=&quot;KeyComment&quot;>'От&nbspкого</span><br />\
sSubject&nbsp=&nbspSubject&nbsp<span class=&quot;KeyComment&quot;>'Тема&nbspписьма</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>Body&nbsp=&nbsp&quot;<default>&quot;&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>sBody&nbsp=&nbsp&quot;Добрый&nbspдень!&quot;&nbsp+&nbspvbCrLf&nbsp+&nbsp&quot;Отчёт&nbspво&nbspвложении.&quot;&nbsp+&nbspvbCrLf&nbsp+&nbsp&quot;Спасибо&nbspза&nbspобращение!&quot;&nbsp<span class=&quot;KeyWord&quot;>Else&nbsp</span>sBody&nbsp=&nbspBody&nbsp<span class=&quot;KeyComment&quot;>'Текст&nbspписьма</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>CCAddress&nbsp<>&nbsp&quot;&quot;&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>sCC&nbsp=&nbspCCAddress&nbsp<span class=&quot;KeyComment&quot;>'Получатели&nbspкопии&nbspписьма</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>BCCAddress&nbsp<>&nbsp&quot;&quot;&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>sBCC&nbsp=&nbspBCCAddress&nbsp<span class=&quot;KeyComment&quot;>'Получатели&nbspскрытой&nbspкопии&nbspписьма</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>Dir(Attachment)&nbsp<>&nbsp&quot;&quot;&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>sAttachment&nbsp=&nbspAttachment&nbsp<span class=&quot;KeyComment&quot;>'Вложение(полный&nbspпуть&nbspк&nbspфайлу)</span><br />\
<span class=&quot;KeyComment&quot;>'Назначаем&nbspконфигурацию&nbspCDO</span><br />\
<span class=&quot;KeyWord&quot;>Set&nbsp</span>oCDOCnf&nbsp=&nbspCreateObject(&quot;CDO.Configuration&quot;)<br />\
<span class=&quot;KeyWord&quot;>With&nbsp</span>oCDOCnf.Fields<br />\
&nbsp&nbsp&nbsp&nbsp.Item(CDO_Cnf&nbsp&&nbsp&quot;sendusing&quot;)&nbsp=&nbsp2<br />\
&nbsp&nbsp&nbsp&nbsp.Item(CDO_Cnf&nbsp&&nbsp&quot;smtpauthenticate&quot;)&nbsp=&nbsp1<br />\
&nbsp&nbsp&nbsp&nbsp.Item(CDO_Cnf&nbsp&&nbsp&quot;smtpserver&quot;)&nbsp=&nbspSMTPserver<br />\
&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyComment&quot;>'если&nbspнеобходимо&nbspуказать&nbspSSL</span><br />\
&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyComment&quot;>'.Item(CDO_Cnf&nbsp&&nbsp&quot;smtpserverport&quot;)&nbsp=&nbsp465&nbsp'для&nbspЯндекса&nbspи&nbspGmail&nbsp465</span><br />\
&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyComment&quot;>'.Item(CDO_Cnf&nbsp&&nbsp&quot;smtpusessl&quot;)&nbsp=&nbspTrue</span><br />\
&nbsp&nbsp&nbsp&nbsp.Item(CDO_Cnf&nbsp&&nbsp&quot;sendusername&quot;)&nbsp=&nbspsUsername<br />\
&nbsp&nbsp&nbsp&nbsp.Item(CDO_Cnf&nbsp&&nbsp&quot;sendpassword&quot;)&nbsp=&nbspsPass<br />\
&nbsp&nbsp&nbsp&nbsp.Update<br />\
<span class=&quot;KeyWord&quot;>End&nbsp</span><span class=&quot;KeyWord&quot;>With</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>sTo&nbsp<>&nbsp&quot;&quot;&nbsp<span class=&quot;KeyWord&quot;>Then</span><br />\
&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>If&nbsp</span>sAttachment&nbsp=&nbsp&quot;&quot;&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span><span class=&quot;KeyComment&quot;>'Проверка&nbspналичия&nbspфайла&nbspпо&nbspуказанному&nbspпути</span><br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspMsgBox&nbsp&quot;Письмо&nbspдля&nbspадресата&nbsp'&quot;&nbsp+&nbspsTo&nbsp+&nbsp&quot;'&nbspне&nbspотправлено!&quot;&nbsp+&nbspvbCrLf&nbsp+&nbsp&quot;Вложение&nbsp'&quot;&nbsp+&nbspsAttachment&nbsp+&nbsp&quot;'&nbspне&nbspнайдено!)&quot;,&nbsp16,&nbsp&quot;&quot;<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspsAttachment&nbsp=&nbsp&quot;&quot;<br />\
&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Else</span><br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyComment&quot;>'Создаем&nbspсообщение</span><br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Set&nbsp</span>oCDOMsg&nbsp=&nbspCreateObject(&quot;CDO.Message&quot;)<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>With&nbsp</span>oCDOMsg<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Set&nbsp</span>.Configuration&nbsp=&nbspoCDOCnf<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.BodyPart.Charset&nbsp=&nbsp&quot;koi8-r&quot;<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.FROM&nbsp=&nbspsFrom<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.<span class=&quot;KeyWord&quot;>To&nbsp</span>=&nbspsTo<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>If&nbsp</span>sCC&nbsp<>&nbsp&quot;&quot;&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>.CC&nbsp=&nbspsCC<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>If&nbsp</span>sBCC&nbsp<>&nbsp&quot;&quot;&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>.BCC&nbsp=&nbspsBCC<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.Subject&nbsp=&nbspsSubject<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.TextBody&nbsp=&nbspsBody<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>If&nbsp</span>Len(sAttachment)&nbsp>&nbsp0&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>.AddAttachment&nbspsAttachment<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp.SEnd<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>End&nbsp</span><span class=&quot;KeyWord&quot;>With</span><br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Select&nbsp</span><span class=&quot;KeyWord&quot;>Case&nbsp</span>err.Number<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Case&nbsp</span>-2147220973:&nbspsMsg&nbsp=&nbspsMsg&nbsp+&nbsp&quot;Нет&nbspдоступа&nbspк&nbspИнтернет&quot;:&nbsplMsg&nbsp=&nbsp16<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Case&nbsp</span>-2147220975:&nbspsMsg&nbsp=&nbspsMsg&nbsp+&nbsp&quot;Отказ&nbspсервера&nbspSMTP&quot;:&nbsplMsg&nbsp=&nbsp16<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Case&nbsp</span>0:&nbspsMsg&nbsp=&nbspsMsg&nbsp+&nbsp&quot;Письмо&nbspдля&nbspадресата&nbsp'&quot;&nbsp+&nbspsTo&nbsp+&nbsp&quot;'&nbspотправлено!&quot;&nbsp+&nbspvbCrLf&nbsp+&nbsp&quot;Вложение&nbsp'&quot;&nbsp+&nbspsAttachment&nbsp+&nbsp&quot;'.)&quot;&nbsp+&nbspvbCrLf<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>Case&nbsp</span><span class=&quot;KeyWord&quot;>Else</span>:&nbspsMsg&nbsp=&nbspsMsg&nbsp+&nbsperr.Description:&nbsplMsg&nbsp=&nbsp16<br />\
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>End&nbsp</span><span class=&quot;KeyWord&quot;>Select</span><br />\
&nbsp&nbsp&nbsp&nbsp<span class=&quot;KeyWord&quot;>End&nbsp</span><span class=&quot;KeyWord&quot;>If</span><br />\
<span class=&quot;KeyWord&quot;>End&nbsp</span><span class=&quot;KeyWord&quot;>If</span><br />\
<span class=&quot;KeyWord&quot;>Set&nbsp</span>oCDOMsg&nbsp=&nbsp<span class=&quot;KeyWord&quot;>Nothing</span>:&nbsp<span class=&quot;KeyWord&quot;>Set&nbsp</span>oCDOCnf&nbsp=&nbsp<span class=&quot;KeyWord&quot;>Nothing</span><br />\
<span class=&quot;KeyWord&quot;>If&nbsp</span>IsShowMessage&nbsp<span class=&quot;KeyWord&quot;>And&nbsp</span>lMsg&nbsp<>&nbsp16&nbsp<span class=&quot;KeyWord&quot;>Then&nbsp</span>MsgBox&nbspsMsg,&nbsplMsg,&nbsp&quot;&quot;<br />\
Send_Mail&nbsp=&nbsp<span class=&quot;KeyWord&quot;>True</span><br />\
<span class=&quot;KeyWord&quot;>End&nbsp</span><span class=&quot;KeyWord&quot;>Function</span><br />\
");