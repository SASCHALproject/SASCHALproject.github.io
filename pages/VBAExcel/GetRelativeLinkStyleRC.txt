document.write("\
<span class=&quot;KeyWord&quot;>Public </span><span class=&quot;KeyWord&quot;>Function </span>ПолучитьОтносительнуюСсылкуRC(<span class=&quot;KeyWord&quot;>ByRef </span>oRangeNow <span class=&quot;KeyWord&quot;>As </span>Range, <span class=&quot;KeyWord&quot;>ByRef </span>oRangeLink <span class=&quot;KeyWord&quot;>As </span>Range, <span class=&quot;KeyWord&quot;>Optional </span><span class=&quot;KeyWord&quot;>ByVal </span>IsRangeLinkHead <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>Boolean </span>= <span class=&quot;KeyWord&quot;>False</span>) <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>String</span><br />\
<span class=&quot;KeyWord&quot;>Dim </span>rNow <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>Long</span>: <span class=&quot;KeyWord&quot;>Dim </span>cNow <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>Long</span>: rNow = oRangeNow.Cells.Row: cNow = oRangeNow.Cells.Column<br />\
<span class=&quot;KeyWord&quot;>Dim </span>rLink <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>Long</span>: <span class=&quot;KeyWord&quot;>Dim </span>cLink <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>Long</span>: rLink = oRangeLink.Cells.Row: cLink = oRangeLink.Cells.Column<br />\
<span class=&quot;KeyWord&quot;>Dim </span>rResult <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>Long</span>: <span class=&quot;KeyWord&quot;>Dim </span>cResult <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>Long</span>: rResult = rLink - rNow: cResult = cLink - cNow<br />\
<span class=&quot;KeyWord&quot;>Dim </span>rResultStroka <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>String</span>: <span class=&quot;KeyWord&quot;>Dim </span>cResultStroka <span class=&quot;KeyWord&quot;>As </span><span class=&quot;KeyWord&quot;>String</span><br />\
<span class=&quot;KeyWord&quot;>If </span><span class=&quot;KeyWord&quot;>Not </span>IsRangeLinkHead <span class=&quot;KeyWord&quot;>Then </span>rResultStroka = IIf(rResult = 0, &quot;&quot;, IIf(rResult > 0, <span class=&quot;KeyWord&quot;>CStr</span><span class=&quot;KeyWord&quot;>(</span>rResult<span class=&quot;KeyWord&quot;>)</span>&quot;[&quot; + <span class=&quot;KeyWord&quot;>CStr</span><span class=&quot;KeyWord&quot;>(</span>rResult<span class=&quot;KeyWord&quot;>)</span>+ &quot;]&quot;))<br />\
cResultStroka = IIf(cResult = 0, &quot;&quot;, IIf(cResult > 0, <span class=&quot;KeyWord&quot;>CStr</span><span class=&quot;KeyWord&quot;>(</span>cResult<span class=&quot;KeyWord&quot;>)</span>&quot;[&quot; + <span class=&quot;KeyWord&quot;>CStr</span><span class=&quot;KeyWord&quot;>(</span>cResult<span class=&quot;KeyWord&quot;>)</span>+ &quot;]&quot;))<br />\
ПолучитьОтносительнуюСсылкуRC = &quot;R&quot; + rResultStroka + &quot;C&quot; + cResultStroka<br />\
<span class=&quot;KeyWord&quot;>End </span><span class=&quot;KeyWord&quot;>Function</span><br />\
");